
<html>
<xml id="xtmlStartupDoc">
    <tangram>
        <window>
            <node id="splitter" name="MainWnd" style="0" rows="1" cols="2" height="483," width="200,377,">
                <node name="Start_S0000" id="ActiveX" cnnid="testwebpage.html" />
                <node name="Start_S0001" id="TangramTabCtrl" cnnid="TangramTabCtrl.Connector.1" activepage="3" location="1" style="1">
                    <node name="Page1" caption="你好" id="hostview" cnnid="" />
                    <node name="Page2" caption="123456778899" id="CLRCtrl" cnnid="TangramWinFormsApplication.TangramCtrl,TangramWinFormsApplication" />
                    <node name="Page3" caption="abcde" id="CLRCtrl" cnnid="TangramWinFormsApplication.TangramCtrl,TangramWinFormsApplication" />
                </node>
            </node>
        </window>
    </tangram>
</xml>
<xml id="xtmlForms">
    <childframe>
        <xx cmdid="2000" nodetext="Style1">
            <window> <node id="splitter" name="childframe1" style="0" rows="1" cols="2" height="483," width="377,377,"> <node name="Start_S0000" /> <node name="Start_S0001" /> </node> </window>
        </xx>
        <yy cmdid="2001" nodetext="Style12">
            <window> <node id="splitter" name="childframe2" style="0" rows="1" cols="2" height="483," width="200,377,"> <node name="Start_S0000" /> <node name="Start_S0001" id="TangramTabCtrl" cnnid="TangramTabCtrl.Connector.1" activepage="3" location="1" style="1"> <node name="Page1" caption="TangramPage1" id="hostview" cnnid="" /> <node name="Page2" caption="TangramPage2" /> <node name="Page3" caption="TangramPage3" /> </node> </node> </window>
        </yy>

        <zz cmdid="2002" nodetext="Style13">
            <window> <node id="splitter" name="childframe3" style="0" rows="1" cols="2" height="483," width="200,377,"> <node name="Start_S0000" /> <node name="Start_S0001" id="tangramtabwnd" activepage="1"> <node name="Page1" caption="TangramPage1" id="hostview" cnnid="" /> <node name="Page2" caption="TangramPage2" /> <node name="Page3" caption="TangramPage3" /> </node> </node> </window>
        </zz>

        <uu cmdid="2003" nodetext="Style14">
            <window> <node id="splitter" name="childframe4" style="0" rows="1" cols="2" height="483," width="200,377,"> <node name="TangramTree" id="TreeView" checkboxes="1" smartcheckbox="1" sethtml="1" style="1" bkcolor="RGB(128,255,255)" cnnid="http://192.168.9.168/LyncGroup.aspx" onsize="changeDocumentSize" initinfo="?username=%s" caption="LyncGroups"> <treenode> <treenode name=" &lt;font size=&quot;+8&quot; &gt;Welcome to the World of Lync Plus&lt;/font&gt;" checked="0" enabled="1" url1="http://192.168.9.168/test.aspx" text-color="red"> <tangramscript bindwnds="Start_S0001,Start_S0002,"> <bindwnds> <start_s0001> <window> <node name="vd" id="splitter" style="1" rows="1" cols="2" height="159,354," width="200,300," hmin="200" rgblefttop="RGB(0,255,128)" rgbrightbottom="RGB(0,128,128)" middlecolor="RGB(0,128,128)"> <node name="vvv" id="HostView" cnnid="" /> <node name="vd22" id="ActiveX" cnnid="http://www.lyncplus.com" caption="群公告" /> </node> </window> </start_s0001> <start_s0002> <window> <node name="Tangram" id="TangramTab" cnnid="TangramTabbedWnd.TabbedComponent.1" activepage="3" style="27"> <node name="vd21" id="HostView" cnnid="Lyncplus.LyncPlusGroupCtrl,ucplus2clr" caption="test" /> <node name="vd22" id="ActiveX" cnnid="http://www.lyncplus.com" caption="群公告" /> <node name="vd2" id="" cnnid="LyncplusProxy.IMHistory,LyncplusProxy" caption="本地聊天历史记录" /> </node> </window> </start_s0002> </bindwnds> </tangramscript> <breed name="&lt;a href=&quot;app:WM_APP_COMMAND1&quot;&gt;American Staghound&lt;/a&gt;" checked="0" enabled="1"> <tangramscript bindwnds="Start_S0001,Start_S0001,"> <bindwnds> <start_s0001> <window> <node name="vd" id="splitter" style="1" rows="1" cols="2" height="159,354," width="200,300," hmin="200" rgblefttop="RGB(0,255,128)" rgbrightbottom="RGB(0,128,128)" middlecolor="RGB(0,128,128)"> <node name="vvv" id="HostView" cnnid="" /> <node name="vd22" id="ActiveX" cnnid="http://www.lyncplus.com" caption="群公告" /> </node> </window> </start_s0001> </bindwnds> </tangramscript> </breed> <breed name=" &lt;font size=&quot;+12&quot; face=&quot;楷体&quot;&gt;哈哈哈&lt;/font&gt;" checked="0" enabled="1"> <tangramscript bindwnds="Start_S0001,"> <bindwnds> <start_s0001> <window> <node name="Tangram" id="TangramTab" cnnid="TangramTabbedWnd.TabbedComponent.1" activepage="3" style="18"> <node name="vd21" id="HostView" cnnid="Lyncplus.LyncPlusGroupCtrl,ucplus2clr" caption="群成员列表" /> <node name="vd22" id="ActiveX" cnnid="http://www.lyncplus.com" caption="群公告" /> <node name="vd2" id="" cnnid="LyncplusProxy.IMHistory,LyncplusProxy" caption="本地聊天历史记录" /> <node name="vd" id="splitter" style="1" rows="1" cols="2" height="159,354," width="1200,300," hmin="400" rgblefttop="RGB(0,255,128)" rgbrightbottom="RGB(0,128,128)" middlecolor="RGB(128,128,128)" caption="About Word Plus"> <node name="v1d2" id="" cnnid="" caption="About Tangram" /> <node name="vd2111" id="ActiveX" cnnid="http://www.baidu.com" caption="企业办公中心" /> </node> </node> </window> </start_s0001> </bindwnds> </tangramscript> </breed> </treenode> </treenode> </node> <node name="Start_S0001" id="TangramTab" cnnid="TangramTabbedWnd.TabbedComponent.1" activepage="3" style="38"> <node name="Page1" caption="TangramPage1" id="hostview" cnnid="" /> <node name="Page2" caption="TangramPage2" /> <node name="Page3" caption="TangramPage3" /> </node> </node> </window>
        </uu>

        <cc cmdid="2004" nodetext="Style15">
            <window> <node id="splitter" name="childframe5" style="0" rows="1" cols="2" height="483," width="200,377,"> <node name="Pagexx2" caption="TangramPage2" cnnid="HostApp" id="TangramFormView1" /> <node name="Start_S0001" id="TangramTab" cnnid="TangramTabbedWnd.TabbedComponent.1" activepage="3" style="38"> <node name="Page1" caption="TangramMDI" id="TestView" cnnid="TangramView.Connector.1" /> <node name="Page2" caption="TangramPage2" id="CLRCtrl" cnnid="TangramClassLibrary.TangramUserControl,TangramClassLibrary" /> <node name="Page3" caption="TangramPage3" id="CLRCtrl" cnnid="testctrl.ctrl,testctrl" /> </node> </node> </window>
        </cc>

        <vvv cmdid="2005" nodetext="Style16">
            <window> <node name="childframe6" id="TangramTab" cnnid="TangramTabbedWnd.TabbedComponent.1" activepage="3" style="27"> <node name="vd21" id="HostView" cnnid="Lyncplus.LyncPlusGroupCtrl,ucplus2clr" caption="test" /> <node name="vd22" id="ActiveX" cnnid="http://www.lyncplus.com" caption="群公告" /> <node name="vd2" id="" cnnid="LyncplusProxy.IMHistory,LyncplusProxy" caption="本地聊天历史记录" /> </node> </window>
        </vvv>

    </childframe>
</xml>
<script>

    var i = 100;
    function Tangram_OnPageLoaded(/**/SourceWindow, URL) {
        if (SourceWindow == window) {
            Tangram.AddObjToHtml("MdiChild", true, Tangram.External);
            //alert(xtmlStartupDoc.XMLDocument.xml);
            ChildForm = Tangram.CreateFrame(null,MdiChild.ChildClientHandle(), "ChildFrom");
            var Node = ChildForm.Extend("MainForm", xtmlStartupDoc.XMLDocument.xml);
            var html = "HTML Source Code for MdiChild Form : " + Tangram.External.Text + "\r\n\r\n\r\n";
            TangramCore.GetCLRControl(TangramCore.Application, "BottomPanel,subBottomPanel,output_textBox").Text = html + document.body.parentElement.outerHTML;
            TangramCore.TangramPropertyGrid.SelectedObject = MdiChild;
            Tangram.External.FillListView(xtmlForms.XMLDocument.xml);
        }
    }

    //function NodeAction(index, node, func, retInfo,prefix,fix)
    //{
    //    retInfo = func(index, node, retInfo);
    //    var count = node.ChildNodes.NodeCount;
    //    if (count > 0)
    //    {
    //        retInfo = retInfo + prefix;
    //        for (var i = 0; i < count; i++)
    //        {
    //            retInfo = NodeAction(i, node.ChildNodes(i), func, retInfo,prefix,fix);
    //        }
    //        retInfo = retInfo + fix;
    //    }
    //    return retInfo;
    //}


    function NodeAction(node, isRoot) {
        var retInfo = '';
        if (!!isRoot)
            retInfo += '<ul>';
        retInfo += '<li>';
        retInfo += '<a href="javascript:void(0);" onclick="NodeOnClick(this);">';
        retInfo += node.TangramName;
        retInfo += '</a>';
        var count = node.ChildNodes.NodeCount;
        if (count > 0) {
            retInfo += '<ul>';
            for (var i = 0; i < count; i++) {
                retInfo += NodeAction(node.ChildNodes(i));
            }
            retInfo += '</ul>';
        }
        retInfo += '</li>';
        if (!!isRoot)
            retInfo += '</ul>';
        return retInfo;
    }

    function f1(index, obj, x) {
        //alert(obj.TangramName);
        if (index == 0)
            return x + obj.TangramName;
        return x + "," + obj.TangramName;
    }

    function Tangram_OnNodeMouseActivate(Node) {
        if (!!Node.XObject) {
            var win = Tangram.Parent.HTMLWindow("BottomPanel_BottomPanel_ObjectInfo");
            win.document.body.innerHTML = Tangram.GetObjectInfo(Node.XObject, Node.TangramName);
            var win2 = Tangram.HTMLWindow(Node.TangramName);
            if (!!win2) {
                var html = "HTML Source Code for:" + MdiChild.Text + " - " + Node.TangramName + "\r\n\r\n\r\n";
                TangramCore.GetCLRControl(TangramCore.Application, "BottomPanel,subBottomPanel,output_textBox").Text = html + win2.document.documentElement.outerHTML;
            }
        }
    }

    function Tangram_OnDestroy() {
        //alert("Tangram_OnDestroy");
    }

    function Tangram_OnNodeCreated(Node) {
        //var x = "MDIChild NodeCreated:" + Name + " NodeType:" + Node.NodeType;
        //Tangram.AttachEvent(Name, this);
    }

    function MdiChild_OnUserCtrlClick(x, y) {
        var _win = Tangram.HTMLWindow("ChildFrom_MainForm_Start_S0000");
        _win.Command(xx, x, y, this);
        var s = Tangram.Nodes("ChildFrom_MainForm_MainWnd").Name;
        TangramCore.Application.Text = x;
    }

    function MdiChild_OnTangramMDIChildActivated(Sender) {
        TangramCore.TangramPropertyGrid.SelectedObject = MdiChild;
        var win = Tangram.Parent.HTMLWindow("BottomPanel_BottomPanel_ObjectInfo");
        win.document.body.innerHTML = Tangram.GetObjectInfo(MdiChild, "MdiChild");
        var html = "HTML Source Code for MdiChild Form : " + Sender.Text + "\r\n\r\n\r\n";
        TangramCore.GetCLRControl(TangramCore.Application, "BottomPanel,subBottomPanel,output_textBox").Text = html + document.body.parentElement.outerHTML;
    }
    function xx(a, b, c) {
        alert('xx : i = ' + this.i);
        alert('xx : c.i = ' + c.i);
        TangramCore.HostApplication.Text = a + b + c;
    }
    function Tangram_OnBeforeExtendXml(/*BSTR */bstrXml, /*LONGLONG */hWnd) {
        //alert(bstrXml);
    }

    window.onload = function () {

    }
</script>
</html>

